<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shirley's ä¸Šä¸Šç±¤ - Celestial Guidance Edition</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            /* é«˜ç´šè—ç°å¤©å¹•èƒŒæ™¯ */
            background: radial-gradient(ellipse at bottom center, 
                #3a4e63 0%, /* åº•éƒ¨è¼ƒäº®çš„è—ç°è‰² */
                #22303f 50%, /* ä¸­é–“éæ¸¡ */
                #0f1722 100% /* é ‚éƒ¨æ·±é‚ƒå¤œç©º */
            );
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Helvetica Neue', 'PingFang SC', 'Microsoft JhengHei', serif;
            color: #f5f5f5;
            overflow-x: hidden;
            padding: 10px;
            touch-action: pan-y;
            position: relative;
        }

        /* åŒ—æ–—ä¸ƒæ˜Ÿæ¨£å¼ */
        .big-dipper-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            pointer-events: none;
            transition: transform 0.1s ease-out;
            will-change: transform;
        }

        .star {
            position: absolute;
            background: #fff;
            border-radius: 50%;
            box-shadow: 
                0 0 4px 1px #fff, 
                0 0 15px 2px #ffd700,
                0 0 30px rgba(255, 215, 0, 0.4); 
            animation: twinkling 4s infinite alternate ease-in-out;
        }

        /* åŒ—æ–—ä¸ƒæ˜Ÿä½ç½® */
        .s1 { top: 15%; left: 25%; width: 4px; height: 4px; animation-delay: 0s; }
        .s2 { top: 18%; left: 32%; width: 3px; height: 3px; animation-delay: 0.5s; }
        .s3 { top: 22%; left: 38%; width: 4px; height: 4px; animation-delay: 1s; }
        .s4 { top: 28%; left: 42%; width: 4px; height: 4px; animation-delay: 1.5s; opacity: 0.8; }
        .s5 { top: 35%; left: 40%; width: 5px; height: 5px; animation-delay: 2s; }
        .s6 { top: 36%; left: 48%; width: 5px; height: 5px; animation-delay: 2.5s; }
        .s7 { top: 28%; left: 50%; width: 6px; height: 6px; animation-delay: 3s; box-shadow: 0 0 5px 2px #fff, 0 0 20px 4px #ffd700; }

        @keyframes twinkling {
            0% { opacity: 0.3; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.1); }
            100% { opacity: 0.4; transform: scale(0.9); }
        }

        /* å…‰æ•ˆ */
        .global-light-effects {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .holy-ambient {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 120vmax;
            height: 120vmax;
            background: radial-gradient(circle, rgba(255, 230, 150, 0.1) 0%, rgba(255, 215, 0, 0) 60%);
            transform: translate(-50%, -50%);
            mix-blend-mode: screen;
            animation: ambientPulse 8s ease-in-out infinite alternate;
        }

        .light-stream {
            position: absolute;
            width: 200%;
            height: 100px;
            background: linear-gradient(90deg, transparent 0%, rgba(255, 240, 180, 0.08) 50%, transparent 100%);
            transform: rotate(-45deg);
            mix-blend-mode: overlay;
            filter: blur(20px);
            opacity: 0.5;
        }

        .s1-stream { top: -50%; left: -50%; animation: streamFlow 15s linear infinite; }
        .s2-stream { top: 0%; left: -30%; animation: streamFlow 12s linear infinite reverse; animation-delay: -5s;}
        .s3-stream { top: 50%; left: -60%; animation: streamFlow 18s linear infinite; animation-delay: -2s; }

        @keyframes ambientPulse {
            0% { opacity: 0.4; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0.7; transform: translate(-50%, -50%) scale(1.1); }
        }

        @keyframes streamFlow {
            0% { transform: translateY(100vh) rotate(-45deg) translateX(-100%); }
            100% { transform: translateY(-100vh) rotate(-45deg) translateX(100%); }
        }
        
        .container {
            width: 100%;
            max-width: 1400px;
            text-align: center;
            padding: 20px;
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            height: 95vh;
        }
        
        .header {
            flex: 0 0 auto;
            margin-bottom: 20px;
            position: relative;
        }
        
        h1 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 300;
            letter-spacing: clamp(3px, 1vw, 8px);
            color: #FFD700;
            text-transform: uppercase;
            margin-bottom: 10px;
            position: relative;
            display: inline-block;
            text-shadow: 0 0 25px rgba(255, 215, 0, 0.6);
        }
        
        h1::before, h1::after {
            content: 'âœ¦';
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            color: #FFD700;
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            opacity: 0.8;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
        }
        
        h1::before { left: -40px; }
        h1::after { right: -40px; }
        
        .subtitle {
            font-size: clamp(0.8rem, 1.5vw, 1rem);
            color: #D4AF37;
            letter-spacing: 3px;
            font-weight: 300;
            opacity: 0.8;
            text-transform: uppercase;
        }
        
        .main-content {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: flex-end;
            gap: clamp(20px, 4vw, 50px);
            flex: 1;
            padding-bottom: 20px;
            position: relative;
        }
        
        .tube-section {
            flex: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            position: relative;
        }
        
        .bamboo-tube-container {
            position: relative;
            width: clamp(180px, 25vw, 260px);
            height: clamp(400px, 50vh, 550px);
            margin: 0 auto;
            cursor: pointer;
            transition: transform 0.3s ease;
            -webkit-tap-highlight-color: transparent;
            z-index: 20;
            overflow: visible; 
        }

        .bamboo-tube-inner-clipper {
            width: 100%;
            height: 100%;
            position: relative;
            border-radius: 0 0 20px 20px;
            overflow: hidden;
            transform-origin: center bottom;
        }
        
        .bamboo-tube-container:hover {
            transform: translateY(-10px);
        }
        
        .bamboo-tube {
            width: 100%;
            height: 100%;
            background: linear-gradient(95deg, #2a1f12 0%, #5c4a2a 20%, #7a6236 50%, #46341d 80%, #1f180f 100%);
            position: relative;
            box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.9), 10px 30px 70px rgba(0, 0, 0, 0.8), 0 0 0 2px rgba(212, 175, 55, 0.3);
        }
        
        @keyframes shaking {
            0%, 100% { transform: rotate(0deg); }
            10% { transform: rotate(-8deg) translateY(-5px); }
            20% { transform: rotate(8deg) translateY(-8px); }
            30% { transform: rotate(-8deg) translateY(-5px); }
            40% { transform: rotate(8deg) translateY(-8px); }
            50% { transform: rotate(-8deg) translateY(-5px); }
            60% { transform: rotate(8deg) translateY(-8px); }
            70% { transform: rotate(-8deg) translateY(-5px); }
            80% { transform: rotate(8deg) translateY(-8px); }
            90% { transform: rotate(-4deg) translateY(-4px); }
        }
        
        .bamboo-tube-inner-clipper.shaking {
            animation: shaking 0.8s ease-in-out infinite;
        }
        
        .bamboo-knots {
            position: absolute;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(to bottom, transparent, transparent 80px, rgba(0, 0, 0, 0.4) 80px, rgba(212, 175, 55, 0.4) 82px, rgba(0, 0, 0, 0.4) 84px);
            z-index: 2;
            pointer-events: none;
        }
        
        .bamboo-tube::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: radial-gradient(ellipse at center, #1a120b 40%, #2d2215 100%);
            border-radius: 20px 20px 50% 50% / 20px 20px 10px 10px;
            box-shadow: inset 0 -5px 15px rgba(0,0,0,0.8);
            z-index: 3;
        }
        
        .fortune-sticks-inside {
            position: absolute;
            width: 70%;
            height: 100%;
            top: 0;
            left: 15%;
            z-index: 1;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            overflow: visible;
            padding-bottom: 20px;
        }
        
        .fortune-stick-inside {
            width: clamp(6px, 1vw, 10px);
            height: 140%; 
            background: linear-gradient(90deg, #966f0f, #ffd700, #966f0f);
            margin: 0 -2px;
            border-radius: 4px 4px 2px 2px;
            box-shadow: 1px 0 3px rgba(0,0,0,0.6);
            transform-origin: bottom center;
            position: relative;
            bottom: -35%; 
        }
        
        .fortune-stick-inside::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 10%;
            width: 80%;
            height: 20px;
            background-color: rgba(180, 40, 40, 0.9);
            border-radius: 2px;
            box-shadow: 0 0 5px rgba(255,0,0,0.3);
        }
        
        .shake-hint {
            color: #FFD700;
            font-size: clamp(0.9rem, 1.5vw, 1.1rem);
            letter-spacing: 2px;
            margin-top: 30px;
            opacity: 0.8;
            background: rgba(0, 0, 0, 0.4);
            padding: 12px 30px;
            border-radius: 30px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }
        
        .shake-hint:hover {
            background: rgba(255, 215, 0, 0.1);
            border-color: #FFD700;
        }
        
        .sticks-area {
            flex: 1;
            height: clamp(250px, 35vh, 400px);
            max-width: 350px;
            position: relative;
            background: linear-gradient(180deg, rgba(30, 40, 50, 0.4) 0%, rgba(15, 20, 25, 0.7) 100%);
            border-radius: 20px;
            border: 1px solid rgba(255, 215, 0, 0.2);
            backdrop-filter: blur(10px);
            box-shadow: inset 0 0 30px rgba(0,0,0,0.5), 0 10px 30px rgba(0,0,0,0.3);
            display: flex;
            justify-content: center;
            align-items: flex-end;
            padding-bottom: 20px;
            overflow: hidden;
        }
        
        .sticks-area::before {
            content: "YOUR FORTUNE";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: rgba(255, 215, 0, 0.07);
            font-size: 2rem;
            font-weight: bold;
            white-space: nowrap;
            pointer-events: none;
            writing-mode: vertical-rl;
            letter-spacing: 10px;
        }
        
        .flying-stick {
            position: fixed;
            width: 12px;
            height: 180px;
            background: linear-gradient(90deg, #d4af37, #ffd700, #d4af37);
            border-radius: 6px;
            z-index: 100;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
            pointer-events: none;
        }
        
        .fallen-stick {
            position: relative;
            width: clamp(28px, 4vw, 36px);
            height: clamp(200px, 30vh, 260px);
            background: linear-gradient(135deg, #aa8a39 0%, #fceabb 50%, #aa8a39 100%);
            border-radius: 6px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(255, 255, 255, 0.2), 0 0 20px rgba(255, 215, 0, 0.3);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transform: translateY(-50px);
        }
        
        .fallen-stick.landed {
            opacity: 1;
            animation: floatingStick 3s ease-in-out infinite;
        }
        
        @keyframes floatingStick {
            0%, 100% { transform: translateY(0) var(--rotation); box-shadow: 0 10px 20px rgba(0,0,0,0.8), 0 0 20px rgba(255,215,0,0.2); }
            50% { transform: translateY(-10px) var(--rotation); box-shadow: 0 20px 40px rgba(0,0,0,0.6), 0 0 30px rgba(255,215,0,0.4); }
        }
        
        .fallen-stick:hover {
            transform: scale(1.05) translateY(-15px) var(--rotation) !important;
            filter: brightness(1.2);
        }
        
        .fallen-stick::before {
            content: "ä¸Šä¸Šç±¤";
            color: #5c4a2a;
            font-size: 1.2rem;
            font-weight: 900;
            writing-mode: vertical-rl;
            letter-spacing: 8px;
            text-shadow: 0 1px 0 rgba(255,255,255,0.4);
        }
        
        .fallen-stick .tap-hint {
            position: absolute;
            bottom: -40px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            color: #FFD700;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .fallen-stick:hover .tap-hint {
            opacity: 1;
        }

        .fortune-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 33, 0.95);
            backdrop-filter: blur(15px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.6s ease;
        }
        
        .fortune-modal.active {
            display: flex;
            opacity: 1;
        }
        
        .holy-radiance {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 150vmax;
            height: 150vmax;
            background: conic-gradient(from 0deg, transparent 0%, rgba(255, 215, 0, 0.2) 10%, transparent 20%, rgba(255, 215, 0, 0.25) 30%, transparent 40%, rgba(255, 215, 0, 0.2) 50%, transparent 60%, rgba(255, 215, 0, 0.25) 70%, transparent 80%, rgba(255, 215, 0, 0.2) 90%, transparent 100%);
            transform: translate(-50%, -50%);
            z-index: -1;
            opacity: 0;
            pointer-events: none;
            mix-blend-mode: screen;
        }
        
        .fortune-modal.active .holy-radiance {
            opacity: 1;
            animation: rotateRadiance 20s linear infinite;
        }
        
        @keyframes rotateRadiance {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        .fortune-card {
            background: radial-gradient(circle at center, #2a3b4c 0%, #1a2533 100%);
            width: 90%;
            max-width: 800px;
            border-radius: 30px;
            padding: clamp(30px, 5vw, 50px);
            border: 2px solid rgba(212, 175, 55, 0.5);
            box-shadow: 0 0 100px rgba(255, 215, 0, 0.3), inset 0 0 50px rgba(0, 0, 0, 0.5);
            position: relative;
            transform: scale(0.8);
            opacity: 0;
            transition: all 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .fortune-card.active {
            transform: scale(1);
            opacity: 1;
        }
        
        .fortune-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(212, 175, 55, 0.3);
            padding-bottom: 20px;
        }
        
        .fortune-title {
            font-size: clamp(2rem, 4vw, 3rem);
            color: #FFD700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
            margin-bottom: 10px;
        }
        
        .fortune-subtitle {
            color: #D4AF37;
            font-size: 1.1rem;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        .fortune-content {
            background: rgba(30, 40, 50, 0.5);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            border: 1px solid rgba(255,215,0,0.1);
        }
        
        .fortune-chinese {
            font-size: clamp(1.8rem, 3vw, 2.5rem);
            color: #fff;
            margin-bottom: 15px;
            font-weight: bold;
            line-height: 1.4;
            text-shadow: 0 2px 5px rgba(0,0,0,0.5);
        }
        
        .fortune-english {
            font-size: clamp(1rem, 2vw, 1.4rem);
            color: #e0c060;
            font-style: italic;
            font-weight: 300;
        }
        
        .fortune-annotation {
            text-align: left;
            padding: 20px;
            background: rgba(255, 215, 0, 0.05);
            border-left: 4px solid #FFD700;
            border-radius: 0 10px 10px 0;
        }
        
        .fortune-annotation-title {
            color: #FFD700;
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .annotation-chinese {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 15px;
            color: #ddd;
        }
        
        .annotation-english {
            font-size: 1rem;
            color: #a0a0a0;
            font-style: italic;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 10px;
        }
        
        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: 2px solid #D4AF37;
            color: #D4AF37;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-modal:hover {
            background: #D4AF37;
            color: #000;
            transform: rotate(90deg);
            box-shadow: 0 0 15px #D4AF37;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }
            
            .tube-section {
                flex: none;
                height: auto;
                width: 100%;
            }
            
            .sticks-area {
                width: 90%;
                height: 150px;
                margin-top: 20px;
            }

            .fallen-stick {
                height: 180px;
                width: 30px;
            }
            
            .bamboo-tube-container {
                width: 160px;
                height: 380px;
            }
            
            h1::before, h1::after {
                display: none;
            }

            .big-dipper-container {
                 transition: transform 0.3s ease-out;
            }
        }
    </style>
</head>
<body>
    <div class="global-light-effects">
        <div class="holy-ambient"></div>
        <div class="light-stream s1-stream"></div>
        <div class="light-stream s2-stream"></div>
        <div class="light-stream s3-stream"></div>
    </div>

    <div class="big-dipper-container" id="bigDipper">
        <div class="star s1"></div>
        <div class="star s2"></div>
        <div class="star s3"></div>
        <div class="star s4"></div>
        <div class="star s5"></div>
        <div class="star s6"></div>
        <div class="star s7"></div>
    </div>

    <div class="container">
        <div class="header">
            <h1>Shirley's ä¸Šä¸Šç±¤</h1>
            <p class="subtitle">Best Fortunes for Academic Success</p>
        </div>
        
        <div class="main-content">
            <div class="tube-section">
                <div class="bamboo-tube-container" id="bambooTube">
                    <div class="bamboo-tube-inner-clipper" id="tubeClipper">
                        <div class="bamboo-tube" id="tubeElement">
                            <div class="bamboo-knots"></div>
                            <div class="fortune-sticks-inside" id="fortuneSticksInside">
                                </div>
                        </div>
                    </div>
                </div>
                <div class="shake-hint">CLICK TO SHAKE â€¢ é»æ“Šæ–ç±¤<br><span style="font-size:0.8em; opacity:0.7">Sound On ğŸ”Š</span></div>
            </div>
            
            <div class="sticks-area" id="sticksArea">
                </div>
        </div>
    </div>
    
    <div class="fortune-modal" id="fortuneModal">
        <div class="holy-radiance"></div>
        <div class="fortune-card" id="fortuneCard">
            <button class="close-modal" id="closeModal">Ã—</button>
            
            <div class="fortune-header">
                <div class="fortune-title" id="fortuneTitle">ä¸Šä¸Šç±¤</div>
                <div class="fortune-subtitle" id="fortuneSubtitle">Academic Excellence</div>
            </div>
            
            <div class="fortune-content" id="fortuneContent">
                </div>
            
            <div class="fortune-annotation">
                <div class="fortune-annotation-title">
                    <span>âœ¦ ç±¤è©©è¨»è§£ â€¢ ANNOTATION</span>
                </div>
                <div class="fortune-annotation-content" id="fortuneAnnotation">
                    </div>
            </div>
        </div>
    </div>

    <script>
        const fortunes = [
            {
                title: "ä¸Šä¸Šå¯¦åŠ›ç±¤",
                chinese: "æ‰€è®€çš†æ‰€è€ƒï¼Œæ‰€å­¸çš†æ‰€ç”¨",
                english: "Every book you've studied will meet you on the test paper.",
                annotation: "é¡Œè§£ï¼šæ‰€è®€çš†æ‰€è€ƒï¼Œæ‰€å­¸çš†æ‰€ç”¨ã€‚é•·æœŸç©ç´¯çš„å­¸è­˜ï¼Œå°‡åœ¨é—œéµæ™‚åˆ»ç™¼æ®ä½œç”¨ã€‚",
                annotation_en: "Every book you've studied will meet you on the test paper."
            },
            {
                title: "ä¸Šä¸Šé®å®šç±¤",
                chinese: "çŸ¥è­˜çŒ¶åœ¨ï¼Œå¿ƒç©©å‰‡æ˜",
                english: "Take a deep breath. Your knowledge is safely stored in your mind, it won't get lost.",
                annotation: "é¡Œè§£ï¼šçŸ¥è­˜çŒ¶åœ¨ï¼Œå¿ƒç©©å‰‡æ˜ã€‚ä¿æŒå†·éœï¼Œä½ çš„å¯¦åŠ›å°‡è‡ªç„¶æµéœ²ã€‚",
                annotation_en: "Take a deep breath. Your knowledge is safely stored in your mind."
            },
            {
                title: "ä¸Šä¸Šç´°å¿ƒç±¤",
                chinese: "æ˜å¯Ÿé¡Œæ„ï¼Œå¦‚è¦‹æœ¬å¿ƒ",
                english: "You will see every detail in the questions, just as you see your own strengths.",
                annotation: "é¡Œè§£ï¼šæ˜å¯Ÿé¡Œæ„ï¼Œå¦‚è¦‹æœ¬å¿ƒã€‚ç´°å¿ƒå¯©é¡Œå°‡å¹«ä½ é¿é–‹é™·é˜±ï¼Œæº–ç¢ºä½œç­”ã€‚",
                annotation_en: "You will see every detail in the questions, just as you see your own strengths."
            },
            {
                title: "ä¸Šä¸Šæ™‚ç­–ç±¤",
                chinese: "æ™‚é–“ç‚ºå‹ï¼Œå¾å®¹æ‡‰å°",
                english: "Time will be your ally, not your enemy.",
                annotation: "é¡Œè§£ï¼šæ™‚é–“ç‚ºå‹ï¼Œå¾å®¹æ‡‰å°ã€‚æŒæ¡ç¯€å¥ï¼Œä½ å°‡æœ‰å……è£•çš„æ™‚é–“å®ŒæˆæŒ‘æˆ°ã€‚",
                annotation_en: "Time will be your ally, not your enemy."
            },
            {
                title: "ä¸Šä¸Šç©©é€²ç±¤",
                chinese: "å…ˆå›ºæ ¹æœ¬ï¼Œé¤˜çš†åŠ æˆ",
                english: "First, secure the points you can. Everything after that is a gift.",
                annotation: "é¡Œè§£ï¼šå…ˆå›ºæ ¹æœ¬ï¼Œé¤˜çš†åŠ æˆã€‚ç©©ç´®ç©©æ‰“ï¼Œæ¯ä¸€åˆ†éƒ½æ˜¯æˆåŠŸçš„åŸºçŸ³ã€‚",
                annotation_en: "First, secure the points you can. Everything after that is a gift."
            },
            {
                title: "ä¸Šä¸Šéˆå…‰ç±¤",
                chinese: "æ€è·¯è‹¥å¡ï¼Œç›´è¦ºå¼•ç‡ˆ",
                english: "When you're stuck, your intuition will light a path for you.",
                annotation: "é¡Œè§£ï¼šæ€è·¯è‹¥å¡ï¼Œç›´è¦ºå¼•ç‡ˆã€‚ç›¸ä¿¡ä½ çš„ç›´è¦ºï¼Œç­”æ¡ˆå¾€å¾€å°±åœ¨è½‰å¿µä¹‹é–“ã€‚",
                annotation_en: "When you're stuck, your intuition will light a path for you."
            },
            {
                title: "ä¸Šä¸Šé †ç­†ç±¤",
                chinese: "ä¸‹ç­†æµæš¢ï¼Œå¦‚å‘¼å¸è‡ªç„¶",
                english: "May your pen flow as naturally as your breath.",
                annotation: "é¡Œè§£ï¼šä¸‹ç­†æµæš¢ï¼Œå¦‚å‘¼å¸è‡ªç„¶ã€‚å¯«ä½œèˆ‡ç­”é¡Œå°‡å¦‚è¡Œé›²æµæ°´èˆ¬é †æš¢ã€‚",
                annotation_en: "May your pen flow as naturally as your breath."
            },
            {
                title: "ä¸Šä¸Šé æ™¯ç±¤",
                chinese: "æ­¤è©¦å¦‚éšï¼Œæœªä¾†å¯æœŸ",
                english: "This test is just a footnote in your brilliant future.",
                annotation: "é¡Œè§£ï¼šæ­¤è©¦å¦‚éšï¼Œæœªä¾†å¯æœŸã€‚çœ¼å…‰æ”¾é ï¼Œé€™åªæ˜¯é€šå¾€æˆåŠŸçš„ä¸€å°æ­¥ã€‚",
                annotation_en: "This test is just a footnote in your brilliant future."
            },
            {
                title: "ä¸Šä¸Šæ–‡æ€ç±¤",
                chinese: "éˆæ„Ÿå¦‚æ³‰æ¹§ï¼Œä¸‹ç­†è‡ªæœ‰ç¥",
                english: "The meaning of classical Chinese will flow naturally through your pen.",
                annotation: "é¡Œè§£ï¼šéˆæ„Ÿå¦‚æ³‰æ¹§ï¼Œä¸‹ç­†è‡ªæœ‰ç¥ã€‚æ–‡æ€æ³‰æ¹§ï¼Œå¤æ–‡æ·±æ„çš†èƒ½é ˜æœƒã€‚",
                annotation_en: "The meaning of classical Chinese will flow naturally through your pen."
            },
            {
                title: "ä¸Šä¸Šæ˜é¡ç±¤",
                chinese: "é–±è®€å¦‚é¡ï¼Œç…§è¦‹æ–‡æœ¬çœŸæ„",
                english: "Your reading comprehension will be as clear and thorough as a bright mirror.",
                annotation: "é¡Œè§£ï¼šé–±è®€å¦‚é¡ï¼Œç…§è¦‹æ–‡æœ¬çœŸæ„ã€‚å¿ƒå¦‚æ˜é¡ï¼Œä»»ä½•è€ƒé¡Œé™·é˜±éƒ½ç„¡æ‰€éå½¢ã€‚",
                annotation_en: "Your reading comprehension will be as clear and thorough as a bright mirror."
            },
            {
                title: "ä¸Šä¸Šèªæ„Ÿç±¤",
                chinese: "èªæ„Ÿå¼•è·¯ï¼Œè©å¥çš†é€š",
                english: "Even unfamiliar words will make way for you, because language intuition is on your side.",
                annotation: "é¡Œè§£ï¼šèªæ„Ÿå¼•è·¯ï¼Œè©å¥çš†é€šã€‚èªæ„Ÿå°‡æˆç‚ºä½ æœ€å¥½çš„åš®å°ï¼ŒåŠ©ä½ å…‹æœç”Ÿè©ã€‚",
                annotation_en: "Even unfamiliar words will make way for you, because language intuition is on your side."
            },
            {
                title: "ä¸Šä¸Šæµæš¢ç±¤",
                chinese: "æ–‡æ€æˆéŸ»ï¼Œä¸‹ç­†æˆç« ",
                english: "The structure of your essay will unfold as naturally as a melody.",
                annotation: "é¡Œè§£ï¼šæ–‡æ€æˆéŸ»ï¼Œä¸‹ç­†æˆç« ã€‚æ–‡ç« çµæ§‹å°‡å¦‚æ¨‚ç« èˆ¬è‡ªç„¶å±•é–‹ã€‚",
                annotation_en: "The structure of your essay will unfold as naturally as a melody."
            },
            {
                title: "ä¸Šä¸Šæ€è·¯ç±¤",
                chinese: "é›£é¡Œè¦‹éšï¼Œæ­¥æ­¥ç‚ºç‡Ÿ",
                english: "Complex problems will break down into clear steps before your eyes.",
                annotation: "é¡Œè§£ï¼šé›£é¡Œè¦‹éšï¼Œæ­¥æ­¥ç‚ºç‡Ÿã€‚ç¹é›œçš„é¡Œç›®å°‡åœ¨ä½ çœ¼ä¸­åˆ†è§£ç‚ºæ¸…æ™°çš„æ­¥é©Ÿã€‚",
                annotation_en: "Complex problems will break down into clear steps before your eyes."
            },
            {
                title: "ä¸Šä¸Šç²¾æº–ç±¤",
                chinese: "é‹ç®—å¦‚å°ºï¼Œåˆ†æ¯«ä¸å·®",
                english: "Your calculations will be as precise as a geometric construction.",
                annotation: "é¡Œè§£ï¼šé‹ç®—å¦‚å°ºï¼Œåˆ†æ¯«ä¸å·®ã€‚è¨ˆç®—éç¨‹ç²¾æº–ç„¡èª¤ï¼Œç­”æ¡ˆè‡ªç„¶æµ®ç¾ã€‚",
                annotation_en: "Your calculations will be as precise as a geometric construction."
            },
            {
                title: "ä¸Šä¸Šæ™‚åºç±¤",
                chinese: "æ™‚å…‰æœ‰åºï¼Œå› æœè‡ªæ˜",
                english: "All dates and events will fall into place within the context of your memory.",
                annotation: "é¡Œè§£ï¼šæ™‚å…‰æœ‰åºï¼Œå› æœè‡ªæ˜ã€‚æ­·å²çš„è„ˆçµ¡å°‡åœ¨ä½ è…¦æµ·ä¸­æ¸…æ™°å‘ˆç¾ã€‚",
                annotation_en: "All dates and events will fall into place within the context of your memory."
            },
            {
                title: "ä¸Šä¸Šæ´è¦‹ç±¤",
                chinese: "è¦‹å²å¦‚é¡ï¼Œç…§è¦‹èˆˆè¡°ä¹‹ç†",
                english: "You will see through cause and effect, not just memorize facts.",
                annotation: "é¡Œè§£ï¼šè¦‹å²å¦‚é¡ï¼Œç…§è¦‹èˆˆè¡°ä¹‹ç†ã€‚ä½ å°‡æ´æ‚‰æ­·å²çš„å› æœèˆ‡è¦å¾‹ï¼Œè€Œéæ­»è¨˜ç¡¬èƒŒã€‚",
                annotation_en: "You will see through cause and effect, not just memorize facts."
            },
            {
                title: "ä¸Šä¸Šåœ–æ™¯ç±¤",
                chinese: "åœ°åœ–æˆç•«ï¼Œè¬è±¡åœ¨å¿ƒ",
                english: "Maps, climates, and economic zones will layer into a three-dimensional image in your mind.",
                annotation: "é¡Œè§£ï¼šåœ°åœ–æˆç•«ï¼Œè¬è±¡åœ¨å¿ƒã€‚åœ°ç†ç©ºé–“å°‡åœ¨ä½ è…¦ä¸­ç«‹é«”å‘ˆç¾ã€‚",
                annotation_en: "Maps, climates, and economic zones will layer into a three-dimensional image in your mind."
            },
            {
                title: "ä¸Šä¸Šç³»çµ±ç±¤",
                chinese: "å¤©åœ°ç‚ºç³»çµ±ï¼Œé€£çµè‡ªç„¶æˆ",
                english: "You will see the connections between systems, not just scattered facts.",
                annotation: "é¡Œè§£ï¼šå¤©åœ°ç‚ºç³»çµ±ï¼Œé€£çµè‡ªç„¶æˆã€‚è¬ç‰©ä¹‹é–“çš„é—œè¯å°‡åœ¨ä½ çœ¼å‰è±ç„¶é–‹æœ—ã€‚",
                annotation_en: "You will see the connections between systems, not just scattered facts."
            },
            {
                title: "ä¸Šä¸Šé‚è¼¯ç±¤",
                chinese: "æ³•ç†å¦‚éˆï¼Œç’°ç’°ç›¸æ‰£",
                english: "Legal articles and social issues will reveal clear logical chains in your analysis.",
                annotation: "é¡Œè§£ï¼šæ³•ç†å¦‚éˆï¼Œç’°ç’°ç›¸æ‰£ã€‚é‚è¼¯æ¨æ¼”å°‡å¦‚é–éˆèˆ¬åš´å¯†ï¼Œè«–è¿°ç„¡æ‡ˆå¯æ“Šã€‚",
                annotation_en: "Legal articles and social issues will reveal clear logical chains in your analysis."
            },
            {
                title: "ä¸Šä¸Šå¹³è¡¡ç±¤",
                chinese: "æŒè¡¡è«¸æ–¹ï¼Œè«–è¿°è‡ªæˆ",
                english: "You will balance multiple perspectives and write essays with depth.",
                annotation: "é¡Œè§£ï¼šæŒè¡¡è«¸æ–¹ï¼Œè«–è¿°è‡ªæˆã€‚ä½ å°‡èƒ½æ¬Šè¡¡å¤šæ–¹è§€é»ï¼Œå¯«å‡ºæœ‰æ·±åº¦çš„è«–è¿°ã€‚",
                annotation_en: "You will balance multiple perspectives and write essays with depth."
            },
            {
                title: "ä¸Šä¸Šç›´è¦ºç±¤",
                chinese: "å…¬å¼å³ä¸–ç•Œï¼Œé‹å‹•å¦‚çœ¼è¦‹",
                english: "Formulas and the motion of the real world will play out in sync in your imagination.",
                annotation: "é¡Œè§£ï¼šå…¬å¼å³ä¸–ç•Œï¼Œé‹å‹•å¦‚çœ¼è¦‹ã€‚ç‰©ç†å…¬å¼å°‡èˆ‡ç¾å¯¦ä¸–ç•Œçš„é‹å‹•åœ¨ä½ è…¦ä¸­å®Œç¾åŒæ­¥ã€‚",
                annotation_en: "Formulas and the motion of the real world will play out in sync in your imagination."
            },
            {
                title: "ä¸Šä¸Šè¦å¾‹ç±¤",
                chinese: "è¬ç‰©æœ‰ç†ï¼Œä¸€è¦½å³æ˜",
                english: "You will see the physical laws behind every question at a glance.",
                annotation: "é¡Œè§£ï¼šè¬ç‰©æœ‰ç†ï¼Œä¸€è¦½å³æ˜ã€‚ä½ å°‡ä¸€çœ¼çœ‹ç©¿é¡Œç›®èƒŒå¾Œçš„ç‰©ç†æ³•å‰‡ã€‚",
                annotation_en: "You will see the physical laws behind every question at a glance."
            },
            {
                title: "ä¸Šä¸Šå¹³è¡¡ç±¤",
                chinese: "æ–¹ç¨‹å¼è‡ªå°‹å¹³è¡¡ï¼Œåæ‡‰å¦‚ä½ æ‰€é¡˜",
                english: "Every chemical equation will reach perfect balance for you.",
                annotation: "é¡Œè§£ï¼šæ–¹ç¨‹å¼è‡ªå°‹å¹³è¡¡ï¼Œåæ‡‰å¦‚ä½ æ‰€é¡˜ã€‚åŒ–å­¸åæ‡‰å¼å°‡è‡ªç„¶é”æˆå¹³è¡¡ã€‚",
                annotation_en: "Every chemical equation will reach perfect balance for you."
            },
            {
                title: "ä¸Šä¸Šæ´å¯Ÿç±¤",
                chinese: "åŸå­ä¹‹é–“ï¼Œè‡ªæœ‰å¿…ç„¶",
                english: "You will see the inevitability of reactions between atoms and molecules.",
                annotation: "é¡Œè§£ï¼šåŸå­ä¹‹é–“ï¼Œè‡ªæœ‰å¿…ç„¶ã€‚å¾®è§€ä¸–ç•Œçš„è®ŠåŒ–è¦å¾‹ç›¡åœ¨æŒæ¡ä¹‹ä¸­ã€‚",
                annotation_en: "You will see the inevitability of reactions between atoms and molecules."
            },
            {
                title: "ä¸Šä¸Šç³»çµ±ç±¤",
                chinese: "ç”Ÿå‘½å¦‚ç¶²ï¼Œå±¤å±¤ç›¸ç¹«",
                english: "From cells to ecosystems, every layer of knowledge will integrate perfectly in your mind.",
                annotation: "é¡Œè§£ï¼šç”Ÿå‘½å¦‚ç¶²ï¼Œå±¤å±¤ç›¸ç¹«ã€‚å¾ç´°èƒåˆ°ç”Ÿæ…‹ï¼Œç”Ÿå‘½çŸ¥è­˜å°‡èæœƒè²«é€šã€‚",
                annotation_en: "From cells to ecosystems, every layer of knowledge will integrate perfectly in your mind."
            },
            {
                title: "ä¸Šä¸Šå‹•æ…‹ç±¤",
                chinese: "ç”Ÿç†å¦‚ç•«ï¼Œå‹•æ…‹è‡ªç¾",
                english: "Complex physiological processes will play in your memory like an animation.",
                annotation: "é¡Œè§£ï¼šç”Ÿç†å¦‚ç•«ï¼Œå‹•æ…‹è‡ªç¾ã€‚è¤‡é›œçš„ç”Ÿç†æ©Ÿåˆ¶å°‡å¦‚å‹•ç•«èˆ¬åœ¨ä½ è¨˜æ†¶ä¸­æ’­æ”¾ã€‚",
                annotation_en: "Complex physiological processes will play in your memory like an animation."
            }
        ];

        class ShakeAudio {
            constructor() {
                this.ctx = null;
            }

            init() {
                if (!this.ctx) {
                    this.ctx = new (window.AudioContext || window.webkitAudioContext)();
                }
                if (this.ctx.state === 'suspended') {
                    this.ctx.resume();
                }
            }

            playRattle() {
                this.init();
                const t = this.ctx.currentTime;
                const bufferSize = this.ctx.sampleRate * 0.1;
                const buffer = this.ctx.createBuffer(1, bufferSize, this.ctx.sampleRate);
                const data = buffer.getChannelData(0);
                for (let i = 0; i < bufferSize; i++) {
                    data[i] = Math.random() * 2 - 1;
                }

                for(let i=0; i<5; i++) {
                    const noise = this.ctx.createBufferSource();
                    noise.buffer = buffer;
                    const gain = this.ctx.createGain();
                    noise.playbackRate.value = 0.8 + Math.random() * 0.5;
                    gain.gain.setValueAtTime(0, t + i*0.06);
                    gain.gain.linearRampToValueAtTime(0.2, t + i*0.06 + 0.01);
                    gain.gain.exponentialRampToValueAtTime(0.01, t + i*0.06 + 0.08);
                    noise.connect(gain);
                    gain.connect(this.ctx.destination);
                    noise.start(t + i*0.06);
                }
            }

            playPop() {
                this.init();
                const t = this.ctx.currentTime;
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.frequency.setValueAtTime(400, t);
                osc.frequency.exponentialRampToValueAtTime(800, t + 0.1);
                gain.gain.setValueAtTime(0.3, t);
                gain.gain.exponentialRampToValueAtTime(0.01, t + 0.1);
                osc.connect(gain);
                gain.connect(this.ctx.destination);
                osc.start(t);
                osc.stop(t + 0.1);
            }
            
            playHoly() {
                this.init();
                const freqs = [523.25, 659.25, 783.99, 1046.50];
                const t = this.ctx.currentTime;
                freqs.forEach((f, i) => {
                    const osc = this.ctx.createOscillator();
                    const gain = this.ctx.createGain();
                    osc.type = 'sine';
                    osc.frequency.value = f;
                    gain.gain.setValueAtTime(0, t);
                    gain.gain.linearRampToValueAtTime(0.1, t + 0.5);
                    gain.gain.exponentialRampToValueAtTime(0.001, t + 4.0);
                    osc.connect(gain);
                    gain.connect(this.ctx.destination);
                    osc.start(t);
                    osc.stop(t + 4.0);
                });
            }
        }

        const audioSys = new ShakeAudio();

        const bambooTubeContainer = document.getElementById('bambooTube');
        const tubeClipper = document.getElementById('tubeClipper');
        const tubeElement = document.getElementById('tubeElement');
        const fortuneSticksInside = document.getElementById('fortuneSticksInside');
        const sticksArea = document.getElementById('sticksArea');
        const fortuneModal = document.getElementById('fortuneModal');
        const fortuneCard = document.getElementById('fortuneCard');
        
        // åŒ—æ–—ä¸ƒæ˜Ÿäº’å‹•
        const bigDipper = document.getElementById('bigDipper');
        let mouseX = 0, mouseY = 0;
        const moveFactor = window.innerWidth < 768 ? 0.01 : 0.025;

        document.addEventListener('mousemove', (e) => {
            mouseX = e.clientX - window.innerWidth / 2;
            mouseY = e.clientY - window.innerHeight / 2;
            requestAnimationFrame(() => {
                bigDipper.style.transform = `translate(${mouseX * moveFactor}px, ${mouseY * moveFactor}px)`;
            });
        });

        let isShaking = false;
        let lastFortuneIndex = -1;

        function initSticks() {
            fortuneSticksInside.innerHTML = '';
            for(let i=0; i<30; i++) { // å¢åŠ ä¸€é»è£é£¾ç”¨çš„ç±¤æ¢æ•¸é‡
                const stick = document.createElement('div');
                stick.className = 'fortune-stick-inside';
                stick.style.height = (135 + Math.random() * 25) + '%';
                stick.style.transform = `rotate(${Math.random() * 6 - 3}deg)`;
                stick.style.filter = `brightness(${0.8 + Math.random()*0.4})`;
                stick.style.zIndex = Math.floor(Math.random() * 3);
                fortuneSticksInside.appendChild(stick);
            }
        }

        function shakeTube() {
            if(isShaking) return;
            isShaking = true;
            audioSys.playRattle();
            sticksArea.innerHTML = '';
            tubeClipper.classList.add('shaking');
            
            const sticks = document.querySelectorAll('.fortune-stick-inside');
            const shakeInterval = setInterval(() => {
                sticks.forEach(s => {
                    s.style.transform = `rotate(${Math.random() * 12 - 6}deg) translateY(${Math.random() * 25 - 10}px)`;
                });
            }, 90);

            setTimeout(() => {
                clearInterval(shakeInterval);
                tubeClipper.classList.remove('shaking');
                sticks.forEach(s => {
                    s.style.transform = `rotate(${Math.random() * 6 - 3}deg) translateY(0)`;
                });
                animateJumpStick();
            }, 1500);
        }

        function animateJumpStick() {
            let newIndex;
            if (fortunes.length > 1) {
                do {
                    newIndex = Math.floor(Math.random() * fortunes.length);
                } while (newIndex === lastFortuneIndex);
            } else {
                newIndex = 0;
            }
            
            lastFortuneIndex = newIndex;
            const fortune = fortunes[newIndex];

            const tubeRect = tubeElement.getBoundingClientRect();
            const startX = tubeRect.left + tubeRect.width / 2;
            const startY = tubeRect.top;
            const targetRect = sticksArea.getBoundingClientRect();
            const endX = targetRect.left + targetRect.width / 2;
            const endY = targetRect.bottom - 50;

            const flyStick = document.createElement('div');
            flyStick.className = 'flying-stick';
            document.body.appendChild(flyStick);
            
            audioSys.playPop();

            const animation = flyStick.animate([
                { 
                    transform: `translate(${startX}px, ${startY}px) rotate(0deg) scale(0.6)`,
                    opacity: 0
                },
                { 
                    transform: `translate(${startX}px, ${startY - 80}px) rotate(20deg) scale(1)`,
                    opacity: 1,
                    offset: 0.15
                },
                {
                    transform: `translate(${(startX + endX)/2}px, ${startY - 200}px) rotate(180deg) scale(1.1)`,
                    offset: 0.5
                },
                { 
                    transform: `translate(${endX}px, ${endY}px) rotate(360deg) scale(1)`,
                    opacity: 1
                }
            ], {
                duration: 800,
                easing: 'cubic-bezier(0.25, 1, 0.5, 1)',
                fill: 'forwards'
            });

            animation.onfinish = () => {
                flyStick.remove();
                showLandedStick(fortune);
                isShaking = false;
            };
        }

        function showLandedStick(fortune) {
            const stick = document.createElement('div');
            stick.className = 'fallen-stick';
            
            const randomRot = Math.random() * 10 - 5;
            stick.style.setProperty('--rotation', `rotate(${randomRot}deg)`);
            
            const hint = document.createElement('div');
            hint.className = 'tap-hint';
            hint.textContent = 'ğŸ‘† TAP TO REVEAL';
            stick.appendChild(hint);

            sticksArea.appendChild(stick);
            
            requestAnimationFrame(() => {
                stick.classList.add('landed');
            });

            stick.addEventListener('click', () => {
                openModal(fortune);
            });
        }

        function openModal(data) {
            audioSys.playHoly();
            
            document.getElementById('fortuneTitle').textContent = data.title;
            document.getElementById('fortuneContent').innerHTML = `
                <div class="fortune-chinese">${data.chinese}</div>
                <div class="fortune-english">${data.english}</div>
            `;
            document.getElementById('fortuneAnnotation').innerHTML = `
                <div class="annotation-chinese">${data.annotation}</div>
                <div class="annotation-english">${data.annotation_en}</div>
            `;
            
            fortuneModal.classList.add('active');
            setTimeout(() => {
                fortuneCard.classList.add('active');
            }, 100);
        }

        function closeModal() {
            fortuneCard.classList.remove('active');
            setTimeout(() => {
                fortuneModal.classList.remove('active');
            }, 300);
        }

        initSticks();
        
        bambooTubeContainer.addEventListener('click', shakeTube);
        document.getElementById('closeModal').addEventListener('click', closeModal);
        fortuneModal.addEventListener('click', (e) => {
            if(e.target === fortuneModal) closeModal();
        });

        let lastX, lastY, lastZ;
        let lastTime = 0;
        const SHAKE_THRESHOLD = 15;

        if (window.DeviceMotionEvent) {
            window.addEventListener('devicemotion', (e) => {
                const current = e.accelerationIncludingGravity;
                if(!current) return;
                const currentTime = new Date().getTime();
                if ((currentTime - lastTime) > 100) {
                    const diffTime = currentTime - lastTime;
                    lastTime = currentTime;
                    const speed = Math.abs(current.x + current.y + current.z - lastX - lastY - lastZ) / diffTime * 10000;
                    if (speed > SHAKE_THRESHOLD * 50) {
                        shakeTube();
                    }
                    lastX = current.x;
                    lastY = current.y;
                    lastZ = current.z;
                }
            });
        }
    </script>
</body>
</html>
