<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å–®å­—æŒ‘æˆ° U1-10</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Comic Sans MS', 'Arial Rounded MT Bold', sans-serif;
            background-color: #a8e6cf;
            text-align: center;
            color: #333;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 10px;
            background-image: linear-gradient(to bottom, #a8e6cf, #88d4ba);
            touch-action: manipulation;
        }
        
        .device-info {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 1000;
        }
        
        .game-container {
            width: 100%;
            max-width: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            border: 8px solid #ffaaa5;
            display: flex;
            flex-direction: column;
            height: 95vh;
            max-height: 95vh;
        }
        
        h1 {
            color: #ff8b94;
            margin: 5px 0;
            font-size: 1.5rem;
            text-shadow: 2px 2px 0 #fff, 4px 4px 0 rgba(0,0,0,0.1);
            flex-shrink: 0;
        }
        
        .game-content {
            display: flex;
            flex-direction: column;
            flex: 1;
            overflow: hidden;
        }
        
        .start-screen, .game-screen, .end-screen {
            display: flex;
            flex-direction: column;
            flex: 1;
            justify-content: space-between;
            transition: all 0.3s ease;
        }
        
        .screen-content {
            display: flex;
            flex-direction: column;
            flex: 1;
            justify-content: space-around;
        }
        
        .start-screen button, .option, .end-screen button {
            background-color: #ffaaa5;
            color: white;
            border: none;
            padding: 12px 20px;
            margin: 8px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s;
            box-shadow: 0 4px 0 #d46a6a;
            font-family: 'Comic Sans MS', cursive;
            flex-shrink: 0;
            -webkit-user-select: none;
            user-select: none;
            touch-action: manipulation;
        }
        
        .start-screen button:hover, .option:hover, .end-screen button:hover {
            background-color: #ff8b94;
            transform: translateY(-2px);
        }
        
        .start-screen button:active, .option:active, .end-screen button:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #d46a6a;
        }
        
        .word-display {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 10px 0;
            color: #6b5b95;
            min-height: 2.2rem;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.1);
            flex-shrink: 0;
        }
        
        .pos-display {
            font-size: 1.1rem;
            color: #a8e6cf;
            margin-bottom: 10px;
            background-color: #6b5b95;
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            color: white;
            flex-shrink: 0;
        }
        
        .options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
            margin-bottom: 10px;
            flex: 1;
            overflow-y: auto;
            padding: 5px;
        }
        
        .option {
            padding: 12px;
            text-align: center;
            transition: all 0.3s;
            font-size: 1rem;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #a8e6cf;
            color: #333;
            box-shadow: 0 4px 0 #86c7b8;
            border-radius: 15px;
            word-break: break-word;
        }
        
        .timer-container {
            height: 12px;
            background-color: #dcedc1;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.1);
            flex-shrink: 0;
        }
        
        .timer-bar {
            height: 100%;
            background: linear-gradient(to right, #ff8b94, #ffaaa5);
            width: 100%;
            transition: width 0.1s linear;
            border-radius: 10px;
        }
        
        .countdown {
            position: absolute;
            top: -30px;
            left: 0;
            right: 0;
            font-size: 1.5rem;
            font-weight: bold;
            color: #ff8b94;
            text-shadow: 0 0 5px rgba(0,0,0,0.2);
            z-index: 10;
            transition: all 0.3s;
            font-family: 'Comic Sans MS', cursive;
        }
        
        .countdown.pulse {
            animation: pulse 0.5s;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }
        
        .score-display {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 8px;
            color: #6b5b95;
            background-color: #dcedc1;
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            box-shadow: 0 4px 0 #b7d1a0;
            flex-shrink: 0;
        }
        
        .character-container {
            height: 120px;
            margin: 10px 0;
            position: relative;
            background-color: #f0f8ff;
            border-radius: 15px;
            overflow: hidden;
            flex-shrink: 0;
        }
        
        .pig {
            font-size: 70px;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            bottom: 10px;
            transition: all 0.3s;
            animation: bounce 0.5s infinite alternate;
            filter: drop-shadow(2px 4px 0 rgba(0,0,0,0.2));
        }
        
        .pig.fall-over {
            animation: fallOver 0.6s forwards;
        }
        
        @keyframes bounce {
            from { transform: translateX(-50%) translateY(0); }
            to { transform: translateX(-50%) translateY(-10px); }
        }
        
        @keyframes fallOver {
            0% { transform: translateX(-50%) rotate(0deg); }
            100% { transform: translateX(-50%) rotate(90deg); bottom: -20px; }
        }
        
        .bomb {
            position: absolute;
            right: 30%;
            bottom: 80px;
            font-size: 35px;
            z-index: 5;
            transform: rotate(-20deg);
        }
        
        .fuse {
            position: absolute;
            right: calc(30% + 8px);
            bottom: 115px;
            width: 80px;
            height: 6px;
            background: linear-gradient(to right, #f39c12, #e74c3c);
            transform-origin: right center;
            z-index: 4;
            transition: width 0.1s linear;
            border-radius: 3px;
        }
        
        .flame {
            position: absolute;
            right: calc(30% - 8px);
            bottom: 110px;
            font-size: 20px;
            opacity: 0;
            transform: scale(0);
            transition: all 0.3s;
            z-index: 6;
            animation: flicker 0.1s infinite alternate;
        }
        
        @keyframes flicker {
            0% { opacity: 0.8; transform: scale(0.9); }
            100% { opacity: 1; transform: scale(1.1); }
        }
        
        .explosion {
            position: absolute;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            font-size: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transform: scale(0);
            transition: all 0.3s;
            z-index: 100;
        }
        
        .confetti {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 90;
        }
        
        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0;
            border-radius: 50%;
        }
        
        .end-screen {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            z-index: 100;
            padding: 20px;
            overflow: auto;
        }
        
        .end-screen.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .end-screen h2 {
            color: #ff8b94;
            margin-bottom: 15px;
            font-size: 2rem;
            transform: translateY(-20px);
            opacity: 0;
            transition: all 0.5s;
            text-shadow: 2px 2px 0 #fff;
        }
        
        .end-screen p {
            font-size: 1.3rem;
            margin: 8px 0;
            transform: translateY(-20px);
            opacity: 0;
            transition: all 0.5s 0.2s;
            background-color: rgba(255, 255, 255, 0.7);
            padding: 10px 20px;
            border-radius: 20px;
            color: #6b5b95;
        }
        
        .end-screen button {
            margin-top: 20px;
            background-color: #a8e6cf;
            color: #333;
            transform: translateY(-20px);
            opacity: 0;
            transition: all 0.5s 0.4s;
            padding: 15px 30px;
            font-size: 1.2rem;
            min-width: 180px;
            box-shadow: 0 6px 0 #86c7b8;
            border-radius: 50px;
        }
        
        .end-screen.active h2,
        .end-screen.active p,
        .end-screen.active button {
            transform: translateY(0);
            opacity: 1;
        }
        
        .end-screen button:hover {
            background-color: #86c7b8;
        }
        
        .correct {
            background-color: #a8e6cf !important;
            color: #333 !important;
            transform: scale(1.05);
            box-shadow: 0 4px 0 #86c7b8;
            animation: correctBounce 0.3s;
        }
        
        @keyframes correctBounce {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1.05); }
        }
        
        .wrong {
            background-color: #ffaaa5 !important;
            color: white !important;
            transform: scale(1.05);
            box-shadow: 0 4px 0 #d46a6a;
            animation: shake 0.3s;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
        
        .hidden {
            display: none !important;
        }
        
        /* è¾²å ´è£é£¾å…ƒç´  */
        .farm-decoration {
            position: absolute;
            font-size: 25px;
            z-index: 1;
        }
        
        .sun {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 40px;
            color: #ffd700;
            animation: rotate 20s linear infinite;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .cloud {
            position: absolute;
            font-size: 30px;
            color: white;
            animation: float 15s linear infinite;
        }
        
        @keyframes float {
            0% { transform: translateX(-100px); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateX(calc(100vw + 100px)); opacity: 0; }
        }

        /* è®¾å¤‡æ£€æµ‹å’Œè‡ªé€‚åº”æ ·å¼ */
        .desktop-view {
            /* æ¡Œé¢è®¾å¤‡æ ·å¼ */
        }

        .tablet-view {
            /* å¹³æ¿è®¾å¤‡æ ·å¼ */
        }

        .mobile-view {
            /* æ‰‹æœºè®¾å¤‡æ ·å¼ */
        }

        /* éŠæˆ²æ™‚é–“é¸æ“‡ */
        .time-selector {
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            font-size: 0.95rem;
            color: #6b5b95;
        }

        .time-selector span {
            margin-bottom: 4px;
        }

        .time-btn {
            background-color: #dcedc1;
            color: #333;
            border: none;
            padding: 6px 14px;
            margin: 0 4px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            box-shadow: 0 3px 0 #b7d1a0;
            font-family: 'Comic Sans MS', cursive;
        }

        .time-btn.active {
            background-color: #a8e6cf;
            box-shadow: 0 3px 0 #86c7b8;
        }

        .time-btn:active {
            transform: translateY(2px);
            box-shadow: 0 1px 0 #b7d1a0;
        }

        /* å“åº”å¼è®¾è®¡ä¼˜åŒ– */
        @media (max-width: 768px) {
            .game-container {
                height: 98vh;
                max-height: 98vh;
                padding: 10px;
            }
            
            h1 {
                font-size: 1.3rem;
                margin: 3px 0;
            }
            
            .options-container {
                grid-template-columns: 1fr 1fr;
                gap: 6px;
                margin-bottom: 5px;
            }
            
            .option {
                min-height: 50px;
                font-size: 0.9rem;
                padding: 8px;
            }
            
            .character-container {
                height: 80px;
                margin: 5px 0;
            }
            
            .pig {
                font-size: 50px;
            }
            
            .bomb {
                font-size: 25px;
                bottom: 50px;
            }
            
            .fuse {
                bottom: 75px;
                width: 50px;
            }
            
            .flame {
                bottom: 70px;
                font-size: 15px;
            }
            
            .word-display {
                font-size: 1.5rem;
                margin: 5px 0;
            }
            
            .pos-display {
                font-size: 1rem;
                margin-bottom: 5px;
            }
            
            .score-display {
                font-size: 1.1rem;
                margin-bottom: 5px;
            }
            
            .timer-container {
                margin: 5px 0;
            }
            
            .countdown {
                top: -25px;
                font-size: 1.3rem;
            }
            
            .start-screen button, .end-screen button {
                padding: 10px 15px;
                font-size: 1rem;
                margin: 5px;
            }
            
            .end-screen h2 {
                font-size: 1.8rem;
                margin-bottom: 10px;
            }
            
            .end-screen p {
                font-size: 1.1rem;
                margin: 5px 0;
            }
            
            .end-screen button {
                padding: 10px 20px;
                font-size: 1rem;
                min-width: 150px;
            }

            .time-selector {
                font-size: 0.85rem;
            }

            .time-btn {
                padding: 4px 10px;
                font-size: 0.8rem;
            }
        }
        
        @media (max-width: 480px) {
            .game-container {
                padding: 10px;
                height: 96vh;
                max-height: 96vh;
            }
            
            h1 {
                font-size: 1.2rem;
                margin: 2px 0;
            }
            
            .options-container {
                grid-template-columns: 1fr;
                gap: 5px;
                margin-bottom: 5px;
            }
            
            .option {
                min-height: 45px;
                font-size: 0.85rem;
                padding: 6px;
            }
            
            .character-container {
                height: 70px;
                margin: 5px 0;
            }
            
            .pig {
                font-size: 40px;
            }
            
            .bomb {
                font-size: 20px;
                bottom: 45px;
            }
            
            .fuse {
                bottom: 65px;
                width: 40px;
            }
            
            .flame {
                bottom: 60px;
                font-size: 12px;
            }
            
            .word-display {
                font-size: 1.3rem;
                margin: 5px 0;
            }
            
            .pos-display {
                font-size: 0.9rem;
                margin-bottom: 5px;
                padding: 4px 12px;
            }
            
            .score-display {
                font-size: 1rem;
                margin-bottom: 5px;
                padding: 4px 12px;
            }
            
            .timer-container {
                margin: 5px 0;
                height: 10px;
            }
            
            .countdown {
                top: -20px;
                font-size: 1.1rem;
            }
            
            .start-screen button, .end-screen button {
                padding: 8px 12px;
                font-size: 0.9rem;
                margin: 4px;
            }
            
            .end-screen h2 {
                font-size: 1.5rem;
                margin-bottom: 8px;
            }
            
            .end-screen p {
                font-size: 1rem;
                margin: 4px 0;
                padding: 8px 15px;
            }
            
            .end-screen button {
                padding: 8px 16px;
                font-size: 0.9rem;
                min-width: 120px;
                margin-top: 15px;
            }
            
            .sun {
                font-size: 30px;
            }
            
            .cloud {
                font-size: 25px;
            }
        }
        
        /* å¹³æ¿ä¼˜åŒ– */
        @media (min-width: 769px) and (max-width: 1024px) {
            .game-container {
                max-width: 700px;
                height: 90vh;
                max-height: 90vh;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .options-container {
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }
            
            .option {
                min-height: 70px;
                font-size: 1rem;
            }
            
            .character-container {
                height: 100px;
            }
            
            .pig {
                font-size: 60px;
            }
        }
        
        /* æ¡Œé¢è®¾å¤‡ä¼˜åŒ– - å¤§å¹…å¢åŠ å­—ä½“å¤§å° */
        @media (min-width: 1025px) {
            .game-container {
                max-width: 900px;
                height: 85vh;
                max-height: 85vh;
                padding: 25px;
            }
            
            h1 {
                font-size: 2.8rem !important;
                margin: 15px 0;
            }
            
            .options-container {
                grid-template-columns: 1fr 1fr;
                gap: 15px;
                margin-bottom: 20px;
            }
            
            .option {
                min-height: 100px !important;
                font-size: 1.4rem !important;
                padding: 20px !important;
                border-radius: 20px !important;
            }
            
            .character-container {
                height: 160px;
                margin: 20px 0;
            }
            
            .pig {
                font-size: 100px !important;
            }
            
            .bomb {
                font-size: 50px !important;
                bottom: 110px;
            }
            
            .fuse {
                bottom: 160px;
                width: 100px;
                height: 8px;
            }
            
            .flame {
                bottom: 150px;
                font-size: 30px !important;
            }
            
            .word-display {
                font-size: 2.5rem !important;
                margin: 20px 0;
            }
            
            .pos-display {
                font-size: 1.5rem !important;
                margin-bottom: 15px;
                padding: 10px 25px;
            }
            
            .score-display {
                font-size: 1.8rem !important;
                margin-bottom: 15px;
                padding: 10px 25px;
            }
            
            .timer-container {
                margin: 15px 0;
                height: 15px;
            }
            
            .countdown {
                top: -35px;
                font-size: 2rem !important;
            }
            
            .start-screen button, .end-screen button {
                padding: 18px 35px !important;
                font-size: 1.5rem !important;
                margin: 15px;
                border-radius: 60px;
            }
            
            .end-screen h2 {
                font-size: 3rem !important;
                margin-bottom: 25px;
            }
            
            .end-screen p {
                font-size: 1.8rem !important;
                margin: 15px 0;
                padding: 15px 30px;
            }
            
            .end-screen button {
                padding: 18px 35px !important;
                font-size: 1.5rem !important;
                min-width: 250px;
                margin-top: 30px;
            }
            
            .sun {
                font-size: 60px;
            }
            
            .cloud {
                font-size: 45px;
            }
            
            .farm-decoration {
                font-size: 35px;
            }
        }
        
        /* å¤§å±å¹•æ¡Œé¢è®¾å¤‡ä¼˜åŒ– */
        @media (min-width: 1440px) {
            .game-container {
                max-width: 1100px;
                padding: 30px;
            }
            
            h1 {
                font-size: 3.2rem !important;
            }
            
            .option {
                min-height: 120px !important;
                font-size: 1.6rem !important;
            }
            
            .word-display {
                font-size: 3rem !important;
            }
        }
        
        /* æ¨ªå±å°ˆç”¨æ¨£å¼ */
        @media (orientation: landscape) {
            .game-container {
                height: 98vh;
                max-height: 98vh;
                padding: 10px;
            }
            
            h1 {
                font-size: 1.3rem;
                margin: 3px 0;
            }
            
            .options-container {
                grid-template-columns: 1fr 1fr;
                gap: 6px;
                margin-bottom: 5px;
            }
            
            .option {
                min-height: 50px;
                font-size: 0.9rem;
                padding: 8px;
            }
            
            .character-container {
                height: 80px;
                margin: 5px 0;
            }
            
            .pig {
                font-size: 50px;
            }
            
            .bomb {
                font-size: 25px;
                bottom: 50px;
            }
            
            .fuse {
                bottom: 75px;
                width: 50px;
            }
            
            .flame {
                bottom: 70px;
                font-size: 15px;
            }
            
            .word-display {
                font-size: 1.5rem;
                margin: 5px 0;
            }
            
            .pos-display {
                font-size: 1rem;
                margin-bottom: 5px;
            }
            
            .score-display {
                font-size: 1.1rem;
                margin-bottom: 5px;
            }
            
            .timer-container {
                margin: 5px 0;
            }
            
            .countdown {
                top: -25px;
                font-size: 1.3rem;
            }
            
            .start-screen button, .end-screen button {
                padding: 10px 15px;
                font-size: 1rem;
                margin: 5px;
            }
            
            .end-screen h2 {
                font-size: 1.8rem;
                margin-bottom: 10px;
            }
            
            .end-screen p {
                font-size: 1.1rem;
                margin: 5px 0;
            }
            
            .end-screen button {
                padding: 10px 20px;
                font-size: 1rem;
                min-width: 150px;
            }
        }
        
        /* è¶…å°è¢å¹•æ©«å±å„ªåŒ– */
        @media (orientation: landscape) and (max-height: 400px) {
            .character-container {
                height: 60px;
            }
            
            .pig {
                font-size: 40px;
            }
            
            .bomb {
                font-size: 20px;
                bottom: 40px;
            }
            
            .fuse {
                bottom: 60px;
                width: 40px;
            }
            
            .flame {
                bottom: 55px;
                font-size: 12px;
            }
            
            .word-display {
                font-size: 1.3rem;
            }
            
            .options-container {
                grid-template-columns: 1fr;
                gap: 4px;
            }
            
            .option {
                min-height: 40px;
                font-size: 0.8rem;
                padding: 6px;
            }
        }
        
        /* è§¦æ‘¸è®¾å¤‡ä¼˜åŒ– */
        @media (pointer: coarse) {
            .start-screen button, .option, .end-screen button {
                min-height: 50px;
                padding-top: 14px;
                padding-bottom: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="device-info" id="deviceInfo">æ£€æµ‹è®¾å¤‡ä¸­...</div>
    <div class="sun">â˜€ï¸</div>
    <div class="cloud" style="top: 20px; animation-delay: 0s;">â˜ï¸</div>
    <div class="cloud" style="top: 60px; animation-delay: 5s;">â˜ï¸</div>
    <div class="cloud" style="top: 40px; animation-delay: 10s;">â˜ï¸</div>
    
    <div class="game-container">
        <h1>L1 U1-10 å–®å­—æŒ‘æˆ°ç„¡æ¥µé™</h1>
        
        <div class="game-content">
            <div class="start-screen">
                <div class="screen-content">
                    <div class="character-container">
                        <div class="pig">ğŸ·</div>
                        <div class="bomb">ğŸ’£</div>
                        <div class="fuse"></div>
                        <div class="flame">ğŸ”¥</div>
                        <div class="farm-decoration" style="bottom: 15px; left: 15px;">ğŸŒ»</div>
                        <div class="farm-decoration" style="bottom: 15px; right: 15px;">ğŸŒ½</div>
                    </div>

                    <div class="time-selector">
                        <span>é¸æ“‡éŠæˆ²æ™‚é–“ï¼š</span>
                        <div>
                            <button class="time-btn active" data-time="180">3 åˆ†é˜</button>
                            <button class="time-btn" data-time="300">5 åˆ†é˜</button>
                            <button class="time-btn" data-time="600">10 åˆ†é˜</button>
                        </div>
                    </div>

                    <button id="start-btn">é–‹å§‹æŒ‘æˆ°ï¼</button>
                </div>
            </div>
            
            <div class="game-screen hidden">
                <div class="screen-content">
                    <div class="score-display">å¾—åˆ†: <span id="score">0</span></div>
                    <div class="countdown" id="countdown">3:00</div>
                    <div class="timer-container">
                        <div class="timer-bar" id="timer-bar"></div>
                    </div>
                    <div class="word-display" id="word"></div>
                    <div class="pos-display" id="pos"></div>
                    
                    <div class="options-container" id="options-container">
                        <!-- é¸é …å°‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
                    </div>
                    
                    <div class="character-container">
                        <div class="pig" id="pig">ğŸ·</div>
                        <div class="bomb">ğŸ’£</div>
                        <div class="fuse" id="fuse"></div>
                        <div class="flame" id="flame">ğŸ”¥</div>
                        <div class="explosion" id="explosion">ğŸ’¥</div>
                        <div class="confetti" id="confetti"></div>
                        <div class="farm-decoration" style="bottom: 15px; left: 15px;">ğŸ”</div>
                        <div class="farm-decoration" style="bottom: 15px; right: 15px;">ğŸ„</div>
                    </div>
                </div>
            </div>
            
            <div class="end-screen">
                <h2>éŠæˆ²çµæŸï¼</h2>
                <p>ä½ çš„æœ€çµ‚å¾—åˆ†: <span id="final-score">0</span></p>
                <p>ç”¨æ™‚: <span id="time-used">0</span>ç§’</p>
                <button id="restart-btn">å†ç©ä¸€æ¬¡</button>
                <div class="farm-decoration" style="bottom: 40px; left: 40px; font-size: 35px;">ğŸ‘</div>
                <div class="farm-decoration" style="bottom: 20px; right: 40px; font-size: 40px;">ğŸšœ</div>
            </div>
        </div>
        
        <!-- å–®å­—åº«å€åŸŸ -->
        <textarea id="word-database" style="display: none;">
action,n,å‹•ä½œ
afternoon,n,ä¸‹åˆ;åˆå¾Œ
air,n,ç©ºæ°£
banana,n,é¦™è•‰
brown,adj;n,è¤è‰²çš„;æ£•è‰²çš„;æ£•è‰²
card,n,å¡ç‰‡
eat,v,åƒ
farm,n,è¾²å ´
fifteen,n;adj,åäº”(çš„)
first,adv,å…ˆ;é¦–å…ˆ;ç¬¬ä¸€;é¦–æ¬¡
hand,v,é¢äº¤;çµ¦;å‚³é
idea,n,ä¸»æ„
large,adj,å¤§çš„
make,v,è£½é€ ; ä½¿å¾—
many,adj,å¾ˆå¤šçš„
May,n,äº”æœˆ
outside,n,å¤–é¢;å¤–éƒ¨;å¤–å´;å¤–è¡¨
please,v,è«‹;å–æ‚…
question,v,è©¢å•
radio,v,ç”¨ç„¡ç·šé›»å‚³é€
room,n;v,æˆ¿é–“; å±…ä½; ç‚º...æä¾›ä½è™•
shall,v,å°‡;æ‡‰è©²
shot,n,å°„æ“Š;é–‹æ§;æŠ•ç±ƒ;æ‹æ”
soil,n,åœŸ;æ³¥åœŸ;åœŸå£¤
study,v,å­¸ç¿’;è®€æ›¸
time,v,è¨˜éŒ„...çš„æ™‚é–“;ä½¿åˆæ‹å­
too,adv,ä¹Ÿæ˜¯;éæ–¼
toward,prep,å‘;å°
welcome,n,æ­¡è¿;æ¬¾å¾…;æ­¡è¿è¾­
yes,n,è‚¯å®šçš„å›ç­”;åŒæ„;è´Šæˆç¥¨
almost,adv,å¹¾ä¹
animal,n,å‹•ç‰©
begin,v,é–‹å§‹
cost,v,èŠ±è²»
fight,n,æ‰“æ¶;æˆ°é¬¥
finish,n,çµæŸ;(å‚¢å…·ç­‰)æœ«é“æ¼†
funny,adj,å¯ç¬‘çš„;æ»‘ç¨½çš„
haircut,n,ç†é«®
home,adv,åœ¨å®¶;å›å®¶;åˆ°å®¶
hurt,v,å‚·å®³;ä½¿ç–¼ç—›
level,n,æ°´å¹³ç·š
mail,v,å¯„ä¿¡
nine,n;adj,ä¹(çš„)
on,prep,åœ¨â€¦ä¸Šé¢
only,conj,å¯æ˜¯;ä¸é;è¦ä¸æ˜¯;è‹¥é
plant,n,æ¤ç‰©;è¾²ä½œç‰©;å·¥å» 
soda,n,è˜‡æ‰“;æ±½æ°´
sound,v,è½èµ·ä¾†
strong,adj,å¼·å£¯çš„
ticket,v,åŠ æ¨™ç±¤æ–¼;é–‹é•è¦ç½°å–®
touch,n,è§¸;ç¢°;æ¥è§¸;æ½¤è‰²;ç‰¹é•·;æ‰èƒ½;å°‘è¨±
town,n,åŸå¸‚
up,prep,å‘...ä¸Š
win,v,è´å¾—
world,n,ä¸–ç•Œ
come,v,åˆ°ä¾†
country,n,åœ‹å®¶;é„‰ä¸‹
cowboy,n,ç‰›ä»”
every,adj,æ¯ä¸€å€‹çš„
examination,n,æª¢æŸ¥;èª¿æŸ¥; è€ƒè©¦ (=exam)
except,v,æŠŠ...é™¤å¤–;åå°
frog,n,é’è›™
glad,adj,é«˜èˆˆçš„
goodbye,n,å‘Šåˆ¥
inside,prep,åœ¨â€¦è£¡é¢
laugh,v,ç¬‘
lion,n,ç…å­
never,adv,æ°¸ä¸
paint,v,ç•«åœ–;æ²¹æ¼†
pencil,v,è‰æ“¬;èµ·è‰
piano,n,é‹¼ç´
right,adv,å‘å³åœ°;é¦¬ä¸Š;æ­£å¥½
sand,n,æ²™
second,adj,ç¬¬äºŒçš„;æ¬¡è¦çš„;å‰¯çš„;å¾å±¬çš„
seesaw,n;v,(ç©) è¹ºè¹ºæ¿
sometimes,adv,æœ‰æ™‚å€™
still,adj,éœæ­¢çš„
stop,v,åœæ­¢
wear,v,ç©¿è‘—; ç£¨æ; ä½¿åŠ›ç«­
Wednesday,n,æ˜ŸæœŸä¸‰
well,adv,å¾ˆå¥½åœ°;å……åˆ†åœ°
will,n,æ„å¿—;æ±ºå¿ƒ;éºå›‘
yellow,n;adj,é»ƒè‰²(çš„)
yesterday,adv,æ˜¨å¤©
ago,adv,ä»¥å‰
born,adj,å‡ºç”Ÿçš„;èª•ç”Ÿçš„
care,v;n,é—œå¿ƒ;ç…§é¡§; çœ‹è­·;é—œæ‡·
certain,adj,è‚¯å®šçš„
draw,v,ç•«;ç¹ªè£½;æå¯«
fall,n,ç§‹å¤©
far,adj,é çš„
first,n,ç¬¬ä¸€;ç¬¬ä¸€å€‹;ç¬¬ä¸€å;å„ªç­‰;é–‹å§‹;é–‹å§‹æ™‚é–“
fog,v,ä»¥éœ§ç± ç½©;ä½¿å›°æƒ‘;ä½¿æ¨¡ç³Š
fresh,adj,æ–°é®®çš„
front,v,å‘å‰;åœ¨å‰é¢;é¢å°
front,n,å‰æ–¹
iron,v,ç†¨ç‡™
keeper,n,ä¿ç®¡äºº;å®ˆè¡›
kitten,n,å°è²“
knee,v,ç”¨è†è“‹ç¢°(æ’)
leave,v,é›¢é–‹;ä¸Ÿä¸‹
nurse,n,è­·å£«
out,adv;prep,åœ¨å¤–;å‘å¤–
ready,v,é å…ˆ;äº‹å…ˆ;ä½¿æº–å‚™å¥½
seventy,n;adj,ä¸ƒå(çš„)
smell,n,æ°£å‘³;é¦™å‘³;è‡­å‘³;å—…è¦º;ä¸€å—…;ä¸€è;å°‘è¨±;è·¡è±¡;å½±è¹¤
song,n,æ­Œæ›²
sour,v,ä½¿è®Šé…¸;å­ç…©;è®Šå£
sure,adj,ç¢ºå®š
thus,adv,å¦‚æ­¤;é€™æ¨£
wear,n,ç©¿;æˆ´;ä½©;ç£¨æ
wrong,adv,éŒ¯èª¤åœ°;é‚ªæƒ¡åœ°;ä¸æ­£ç•¶åœ°
again,adv,å†ä¸€æ¬¡
agreement,n,åŒæ„
class,v,æŠŠ...åˆ†é¡;æŠŠ...åˆ†ç­‰ç´š
clean,n,æ‰“æƒ;å»å¢
coat,v,å¡—åœ¨...ä¸Š;çµ¦...ç©¿ä¸Šå¤–å¥—
farmer,n,è¾²å¤«
flower,v,é–‹èŠ±;ç™¼è‚²;æˆç†Ÿ;ç¹æ¦®
history,n,æ­·å²
hole,v,é‘¿æ´æ–¼;ç©¿å­”æ–¼;é€²å…¥æ´ä¸­
job,n,è·æ¥­;å·¥ä½œ
joy,n,æ­¡å–œ;æ¨‚è¶£
other,adj,å…¶ä»–çš„
papa,n,çˆ¸çˆ¸
scene,n,æ™¯è‰²;å ´é¢
selfish,adj,è‡ªç§çš„
set,n,å¥—;çµ„
shine,n,å…‰;å…‰äº®;å…‰æ¾¤;æ“¦äº®;é™½å…‰;æ™´å¤©
something,n,æŸäºº;æŸäº‹;é‡è¦çš„äºº(æˆ–äº‹ç‰©)
special,adj,ç‰¹åˆ¥çš„
thirteen,n;adj,åä¸‰(çš„)
view,v,å¯Ÿçœ‹;å°‡...çœ‹æˆæ˜¯
visit,n,è¨ªå•
welcome,v,æ­¡è¿
whole,n,å…¨éƒ¨;å…¨é«”;æ•´é«”
yet,adv,å°šæœª;ä½†æ˜¯
angry,adj,ç”Ÿæ°£çš„
beat,v;n,æ“Šæ•—;æ•²æ“Š;å¿ƒè·³è²;æ»´ç­”è²;æ‹å­
behind,adv;prep,åœ¨èƒŒå¾Œ;å‘èƒŒå¾Œ;é²;è½å¾Œ
brave,adj,å‹‡æ•¢çš„
camel,n,é§±é§
Christmas,n,è€¶èª•ç¯€
cold,adj,å¯’å†·çš„
daughter,n,å¥³å…’
desk,n,æ›¸æ¡Œ
early,adj,æ—©çš„;ææ—©çš„
English,adj,è‹±æ ¼è˜­çš„;è‹±åœ‹çš„;è‹±åœ‹äººçš„;è‹±èªçš„
for,prep,ç‚ºâ€¦åšçš„;çµ¦
ground,v,ä½¿æ“±æ·º;ä½¿åœé£›;ä¾é ;æ ¹æ“š;åŸºæ–¼
land,v,ç™»é™¸
last,n,æœ€å¾Œçš„äºº(æˆ–æ±è¥¿);æœ€å¾Œ;ä¸Šå›
letter,n,ä¿¡;å­—æ¯
light,v,é»(ç«);é»ç‡ƒ;ç…§äº®
look,n,çœ‹;ç¥;è‡‰è‰²;çœ¼ç¥;è¡¨æƒ…
no,adj,æ²’æœ‰;ä¸
nose,n,é¼»å­
note,v,æ³¨æ„;è¨˜ä¸‹
number,v,ç·¨è™Ÿ;ç¸½æ•¸é”åˆ°;å…±è¨ˆ
pull,v,æ‹‰
race,v,èˆ‡...è³½è·‘
sad,adj,é›£éçš„
save,v,æ•‘;çœ;å­˜éŒ¢
taste,n,å‘³é“;æ»‹å‘³;é«”é©—;é¢¨é›…;å¾—é«”;èˆˆè¶£
wish,n,å¸Œæœ›;é¡˜æœ›;ç¥ç¦;ç¥ˆé Œ
around,adv;prep,åˆ°è™•;å››è™•;å‘¨åœ;é™„è¿‘;ç’°ç¹;å¤§ç´„;å·®ä¸å¤š
beautiful,adj,æ¼‚äº®çš„
correct,v,æ”¹æ­£;ç³¾æ­£
cover,n,å°é¢
date,n,æ—¥æœŸ
dog,n,ç‹—
fat,n,(å‹•;æ¤ç‰©)è„‚è‚ª;æ²¹è„‚
feed,v,åƒ;é¤µé¤Š
first,adj,ç¬¬ä¸€çš„
free,adv,å…è²»åœ°;ç„¡ç´„æŸåœ°;é¬†é–‹è‘—;è„«é–‹è‘—
girl,n,å¥³å­©
grand,adj,é›„å‰çš„;ç¸½çš„
horse,n,é¦¬
hour,n,å°æ™‚
long,adj,é•·çš„
mother,n,æ¯è¦ª
name,n,åå­—
newspaper,n,å ±ç´™
once,n,ä¸€æ¬¡;ä¸€å›
perhaps,adv,æˆ–è¨±;å¯èƒ½
rise,v,èµ·èº«;å‡èµ·
tomorrow,adv,æ˜å¤©
two,n;adj,äºŒ(çš„)
water,v,çµ¦...æ¾†æ°´;åŠ æ°´ç¨€é‡‹;æµå£æ°´
worse,n,æ›´ç³Ÿçš„äº‹
also,adv,ä¹Ÿ
bell,n,éˆ´;é˜
below,adv;prep,åœ¨ä¸‹é¢;åˆ°ä¸‹é¢
blood,n,è¡€
chair,v,ä¸»æŒ(æœƒè­°);ä»»(æœƒè­°çš„)ä¸»å¸­
chance,v,å†’...çš„éšª;è³­(éŒ¢); ç¢°å·§
cloud,v,é™°é›²å¯†ä½ˆ;è®Šæš—;è®Šæ¨¡ç³Š;è®Šæ··æ¿
cola,n,å¯æ¨‚
cook,n,å»šå¸«
early,adv,æ—©;ææ—©
east,n;adj,æ±æ–¹(çš„)
gray,n;adj,ç°è‰²(çš„) (ç¾å¼æ‹¼å¯«)
home,adj,å®¶åº­çš„;åœ‹å…§çš„
key,adj,é‡è¦çš„;åŸºæœ¬çš„;é—œéµçš„
little,adj,å¾ˆå°‘çš„; å°çš„
live,adj,æ´»çš„;æœ‰ç”Ÿå‘½çš„;ç‡ƒè‘—çš„;å¯¦æ³æ’­é€çš„
mother,v,ç”Ÿä¸‹;ç”¢ç”Ÿå‡º;åƒæ¯è¦ªèˆ¬ç…§é¡§
open,v,æ‰“é–‹
out,adv;prep,åœ¨å¤–åœ°
pen,n,åŸå­ç­†;å¢¨æ°´ç­†; ç•œæ¬„
pie,n,æ´¾(é£Ÿå“)
pocket,v,ä¾µå;æ“Š(çƒ)è½è¢‹;å¿å—
pool,v,åˆè¾¦;è¯ç‡Ÿ
purple,n;adj,ç´«è‰²(çš„)
reason,v,æ¨è«–;æ¨ç†
serve,v,æœå‹™
service,v,ç¶­ä¿®;ä¿é¤Š
size,n,å¤§å°;å°ºå¯¸
smell,v,è
soon,adv,å³åˆ»;ä¸ä¹…
soul,n,éˆé­‚
sun,v,æ›¬;æ›; æ›¬å¤ªé™½
tall,adj,é«˜çš„
tie,v,ç¶;ç¹«
weather,v,ç¶“å—åˆ°;ä½¿é¢¨åŒ–;è¤ªè‰²;æå£
west,adv,å‘è¥¿æ–¹
white,n;adj,ç™½è‰² (çš„)
cake,n,è›‹ç³•
climb,v;n,çˆ¬;æ”€ç™»
dancer,n,èˆè¹ˆæ¼”å“¡;èˆè¹ˆå®¶
date,v,ç´„æœƒ; è¨»æ˜æ—¥æœŸ
direct,adj,ç›´æ¥çš„
end,n,ç›¡é ­;çµå±€
inside,n,å…§éƒ¨;è£¡é¢;å…§å¹•
laugh,n,ç¬‘;ç¬‘è²
outside,adv,å¤–é¢åœ°
run,v,è·‘
season,n,å­£ç¯€
short,adj,çŸ®çš„;çŸ­çš„
silver,n,éŠ€
sorry,adj,æŠ±æ­‰;éºæ†¾çš„
station,v,é§ç´®;éƒ¨ç½²;é…ç½®
stop,n,è»Šç«™
such,adj,å¦‚æ­¤çš„
third,adj,ç¬¬ä¸‰
want,n,éœ€è¦çš„æ±è¥¿;å¿…éœ€å“;ç¼ºä¹;åŒ±ä¹
waste,n,æµªè²»
wide,adv,å¼µå¾—(æˆ–é–‹å¾—)å¾ˆå¤§åœ°;å……åˆ†åœ°
wife,n,å¦»å­
wood,n,æœ¨æ
auntie,n,aunt çš„æš±ç¨±
between,adv;prep,åœ¨ä¸­é–“;ä»‹ä¹å…©è€…ä¹‹é–“
body,n,èº«é«”
buy,v;n,è²·; è³¼è²·;ä¾¿å®œè²¨
cool,adj,æ¶¼å¿«çš„;å¾ˆæ£’çš„;é…·
crow,n,é´‰;çƒé´‰
cup,n,æ¯å­
dance,n,èˆæœƒ
downstairs,n;adj;adv,æ¨“ä¸‹(çš„); åœ¨æ¨“ä¸‹
duck,n,é´¨
guess,v,çŒœ
hate,n,ä»‡æ¨;æ†æ¨;å­æƒ¡
heat,n,ç†±æ°£
keep,v,ä¿ç•™;ä¿æŒ
kitchen,n,å»šæˆ¿
lesson,n,èª²;æ•™è¨“
lunch,v,åƒåˆé¤
may,v,å¯èƒ½
mouse,n,è€é¼ ; æ»‘é¼ 
name,v,çµ¦...å–å;åˆ—èˆ‰
nature,n,è‡ªç„¶
parent,n,é›™è¦ªä¹‹ä¸€
pool,n,æ°´æ± ;ç¾å¼æ’çƒ
price,v,çµ¦...å®šåƒ¹
print,v,å°åˆ·;ç”¨å°åˆ·é«”å¯«
remember,v,è¨˜å¾—
rule,n,è¦å‰‡
sharp,adv,æ•´(æŒ‡æ™‚åˆ»);éŠ³åˆ©åœ°;æ©Ÿè­¦åœ°
sing,v,å”±æ­Œ
skin,n,çš®è†š
sleep,n,ç¡çœ ;æ­»äº¡;å†¬çœ 
sour,n;adj,é…¸(çš„) (æ±è¥¿)
store,n,å•†åº—
toy,v,ç©å¼„;æˆ²è€;èª¿æƒ…;èª¿æˆ²
twenty,n;adj,äºŒå(çš„)
week,n,æ˜ŸæœŸ
welcome,adj,å—æ­¡è¿çš„;ä»¤äººæ„‰å¿«çš„;è¢«å…è¨±çš„
when,adv,ä½•æ™‚
write,v,å¯«
        </textarea>
    </div>

    <script>
        // è®¾å¤‡æ£€æµ‹å‡½æ•°
        function detectDevice() {
            const userAgent = navigator.userAgent.toLowerCase();
            const deviceInfo = document.getElementById('deviceInfo');
            let deviceType = 'desktop';
            let screenInfo = '';
            
            // æ£€æµ‹è®¾å¤‡ç±»å‹
            if (/mobile|android|iphone|ipad/.test(userAgent)) {
                if (/ipad|tablet/.test(userAgent) || (window.innerWidth >= 768 && window.innerWidth <= 1024)) {
                    deviceType = 'tablet';
                    screenInfo = 'å¹³æ¿è®¾å¤‡';
                } else {
                    deviceType = 'mobile';
                    screenInfo = 'æ‰‹æœºè®¾å¤‡';
                }
            } else {
                deviceType = 'desktop';
                screenInfo = 'æ¡Œé¢è®¾å¤‡';
            }
            
            // æ·»åŠ è®¾å¤‡ç±»åˆ°body
            document.body.classList.add(deviceType + '-view');
            
            // æ˜¾ç¤ºè®¾å¤‡ä¿¡æ¯
            const screenSize = `å±å¹•: ${window.innerWidth} Ã— ${window.innerHeight}`;
            const dpr = `åƒç´ æ¯”: ${window.devicePixelRatio}`;
            deviceInfo.textContent = `${screenInfo} | ${screenSize} | ${dpr}`;
            
            // æ ¹æ®è®¾å¤‡ç±»å‹è°ƒæ•´æ¸¸æˆå‚æ•°
            adjustForDevice(deviceType);
            
            return deviceType;
        }
        
        // æ ¹æ®è®¾å¤‡ç±»å‹è°ƒæ•´å‚æ•°
        function adjustForDevice(deviceType) {
            const gameContainer = document.querySelector('.game-container');
            
            switch(deviceType) {
                case 'desktop':
                    gameContainer.style.maxWidth = '1000px';
                    break;
                case 'tablet':
                    gameContainer.style.maxWidth = '800px';
                    break;
                case 'mobile':
                    gameContainer.style.maxWidth = '100%';
                    break;
            }
        }
        
        // éŠæˆ²è®Šæ•¸
        let score = 0;
        let currentQuestionIndex = 0;
        let timer;
        let totalGameTime = 180;    // é è¨­ 3 åˆ†é˜ï¼Œç§’æ•¸
        let timeLeft = totalGameTime;
        let startTime;
        let questions = [];
        let usedInCurrentSession = []; // âœ… æœ¬å±€å·²ä½¿ç”¨çš„å–®å­—ç´¢å¼•
        let lastCountdownNumber = 0;
        let isAnswering = false;
        
        // é€£çºŒç­”å° / ç­”éŒ¯è¨ˆæ•¸
        let correctStreak = 0;
        let wrongStreak = 0;

        // éŠæˆ²æ˜¯å¦å·²çµæŸ
        let gameOver = false;
        
        // DOMå…ƒç´ 
        const startScreen = document.querySelector('.start-screen');
        const gameScreen = document.querySelector('.game-screen');
        const endScreen = document.querySelector('.end-screen');
        const startBtn = document.getElementById('start-btn');
        const restartBtn = document.getElementById('restart-btn');
        const wordDisplay = document.getElementById('word');
        const posDisplay = document.getElementById('pos');
        const optionsContainer = document.getElementById('options-container');
        const scoreDisplay = document.getElementById('score');
        const timerBar = document.getElementById('timer-bar');
        const countdownDisplay = document.getElementById('countdown');
        const pig = document.getElementById('pig');
        const fuse = document.getElementById('fuse');
        const flame = document.getElementById('flame');
        const explosion = document.getElementById('explosion');
        const confettiContainer = document.getElementById('confetti');
        const finalScoreDisplay = document.getElementById('final-score');
        const timeUsedDisplay = document.getElementById('time-used');
        const wordDatabase = document.getElementById('word-database');
        const timeButtons = document.querySelectorAll('.time-btn');
        
        // æ™‚é–“æ ¼å¼ï¼šmm:ss
        function formatTime(seconds) {
            seconds = Math.max(0, seconds);
            const m = Math.floor(seconds / 60);
            const s = Math.ceil(seconds % 60);
            return `${m}:${s.toString().padStart(2, '0')}`;
        }

        // åˆå§‹åŒ–éŠæˆ²
        function initGame() {
            // è§£æå–®å­—åº«
            const wordData = wordDatabase.value.trim().split('\n');
            questions = wordData.map(line => {
                const parts = line.trim().split(',');
                if (parts.length >= 3) {
                    return {
                        word: parts[0].trim(),
                        pos: parts[1].trim(),
                        meaning: parts.slice(2).join(',').trim()
                    };
                }
                return null;
            }).filter(q => q !== null && q.word && q.pos && q.meaning);
            
            // é‡ç½®éŠæˆ²ç‹€æ…‹
            score = 0;
            currentQuestionIndex = 0;
            usedInCurrentSession = [];
            lastCountdownNumber = 0;
            isAnswering = false;
            correctStreak = 0;
            wrongStreak = 0;
            gameOver = false;

            clearInterval(timer);

            // ä¾ç›®å‰ active æ™‚é–“æŒ‰éˆ•è¨­å®šç¸½æ™‚é–“
            if (timeButtons.length > 0) {
                let activeBtn = document.querySelector('.time-btn.active') || timeButtons[0];
                timeButtons.forEach(btn => btn.classList.remove('active'));
                activeBtn.classList.add('active');
                totalGameTime = parseInt(activeBtn.dataset.time, 10);
            }

            timeLeft = totalGameTime;
            scoreDisplay.textContent = score;
            countdownDisplay.textContent = formatTime(timeLeft);
            timerBar.style.width = '100%';
            timerBar.style.backgroundColor = '#ff8b94';
            
            // é‡ç½®è¦–è¦ºå…ƒç´ 
            pig.textContent = 'ğŸ·';
            pig.className = 'pig';
            flame.style.opacity = '0';
            flame.style.transform = 'scale(0)';
            fuse.style.width = '80px';
            explosion.style.opacity = '0';
            explosion.style.transform = 'scale(0)';
            confettiContainer.innerHTML = '';
            countdownDisplay.style.color = '#ff8b94';
            countdownDisplay.className = 'countdown';
            
            // é¡¯ç¤ºé–‹å§‹ç•«é¢
            startScreen.classList.remove('hidden');
            gameScreen.classList.add('hidden');
            endScreen.classList.remove('active');
        }

        // é–‹å§‹éŠæˆ²
        function startGame() {
            if (questions.length === 0) {
                alert('å–®å­—åº«è§£æéŒ¯èª¤ï¼Œè«‹æª¢æŸ¥å–®å­—æ ¼å¼ï¼');
                return;
            }
            
            // è®€å–ç›®å‰é¸çš„æ™‚é–“
            const activeBtn = document.querySelector('.time-btn.active');
            if (activeBtn) {
                totalGameTime = parseInt(activeBtn.dataset.time, 10);
            }

            timeLeft = totalGameTime;
            lastCountdownNumber = Math.ceil(timeLeft);
            countdownDisplay.textContent = formatTime(timeLeft);
            timerBar.style.width = '100%';

            score = 0;
            correctStreak = 0;
            wrongStreak = 0;
            gameOver = false;
            scoreDisplay.textContent = score;

            startScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');

            startTime = new Date().getTime();
            clearInterval(timer);
            timer = setInterval(updateTimer, 100);

            loadQuestion();
        }
        
        // è¼‰å…¥å•é¡Œ
        function loadQuestion() {
            if (gameOver) return;

            // é‡ç½®å›ç­”ç‹€æ…‹
            isAnswering = false;
            
            // å¦‚æœæœ¬å±€å·²ç”¨å®Œæ‰€æœ‰å–®å­—ï¼Œæ¸…ç©ºè¨˜éŒ„ä»¥é–‹å§‹æ–°ä¸€è¼ª
            if (usedInCurrentSession.length >= questions.length) {
                usedInCurrentSession = [];
            }
            
            // æ‰¾å‡ºå°šæœªä½¿ç”¨çš„ç´¢å¼•
            const availableIndices = questions
                .map((_, i) => i)
                .filter(i => !usedInCurrentSession.includes(i));
            
            // å®‰å…¨é˜²è­·ï¼šé¿å…ç©ºé™£åˆ—
            if (availableIndices.length === 0) {
                usedInCurrentSession = [];
                loadQuestion();
                return;
            }
            
            // éš¨æ©Ÿé¸æ“‡ä¸€å€‹æœªä½¿ç”¨éçš„å•é¡Œ
            const randomIndex = availableIndices[Math.floor(Math.random() * availableIndices.length)];
            usedInCurrentSession.push(randomIndex); // è¨˜éŒ„æœ¬å±€å·²ä½¿ç”¨
            
            currentQuestionIndex = randomIndex;
            const question = questions[currentQuestionIndex];
            wordDisplay.textContent = question.word;
            posDisplay.textContent = question.pos;
            
            // ç”Ÿæˆé¸é …
            generateOptions(question);
        }
        
        // ç”Ÿæˆé¸é …
        function generateOptions(correctQuestion) {
            optionsContainer.innerHTML = '';
            
            const allMeanings = questions.map(q => q.meaning);
            
            const options = [correctQuestion.meaning];
            while (options.length < 4) {
                const randomIndex = Math.floor(Math.random() * allMeanings.length);
                const randomMeaning = allMeanings[randomIndex];
                
                if (!options.includes(randomMeaning)) {
                    options.push(randomMeaning);
                }
            }
            
            shuffleArray(options);
            
            options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option';
                button.textContent = option;
                button.addEventListener('click', () => {
                    if (!isAnswering && !gameOver) {
                        isAnswering = true;
                        checkAnswer(option, correctQuestion.meaning);
                    }
                });
                optionsContainer.appendChild(button);
            });
        }
        
        // æª¢æŸ¥ç­”æ¡ˆï¼†è¨ˆåˆ†é‚è¼¯
        function checkAnswer(selectedOption, correctAnswer) {
            if (gameOver) return;
            
            const options = document.querySelectorAll('.option');
            options.forEach(option => {
                option.disabled = true;
                if (option.textContent === correctAnswer) {
                    option.classList.add('correct');
                } else if (option.textContent === selectedOption && selectedOption !== correctAnswer) {
                    option.classList.add('wrong');
                }
            });
            
            if (selectedOption === correctAnswer) {
                // âœ… ç­”å°ï¼šé€£çºŒæ­£ç¢º +1ï¼ŒéŒ¯èª¤æ­¸é›¶
                correctStreak++;
                wrongStreak = 0;

                let addScore = 5;
                if (correctStreak === 1) addScore = 5;
                else if (correctStreak === 2) addScore = 10;
                else if (correctStreak === 3) addScore = 15;
                else addScore = 20; // ç¬¬ 4 é¡Œèµ·å°é ‚

                score += addScore;
                scoreDisplay.textContent = score;

                pig.textContent = 'ğŸ·ğŸ‰';
                createConfetti();
                playSound('correct');
                
                setTimeout(() => {
                    if (gameOver) return;
                    pig.textContent = 'ğŸ·';
                    optionsContainer.innerHTML = '';
                    loadQuestion();
                }, 800);
            } else {
                // âŒ ç­”éŒ¯ï¼šé€£çºŒéŒ¯èª¤ +1ï¼Œæ­£ç¢ºæ­¸é›¶
                wrongStreak++;
                correctStreak = 0;

                let penalty = 5;
                if (wrongStreak === 1) penalty = 5;
                else if (wrongStreak === 2) penalty = 10;
                else if (wrongStreak === 3) penalty = 15;
                else penalty = 20;  // ç¬¬ 4 é¡Œèµ·å°é ‚

                score = Math.max(score - penalty, 0);
                scoreDisplay.textContent = score;

                flame.style.opacity = '1';
                flame.style.transform = 'scale(1)';
                explosion.style.opacity = '1';
                explosion.style.transform = 'scale(1.5)';
                pig.className = 'pig fall-over';
                playSound('explosion');
                
                setTimeout(() => {
                    if (gameOver) return;

                    if (score <= 0) {
                        // åˆ†æ•¸æ­¸é›¶ â‡’ éŠæˆ²çµæŸ
                        endGame('score');
                    } else {
                        // é‚„æœ‰åˆ†æ•¸ â‡’ ç¹¼çºŒéŠæˆ²
                        pig.textContent = 'ğŸ·';
                        pig.className = 'pig';
                        flame.style.opacity = '0';
                        flame.style.transform = 'scale(0)';
                        explosion.style.opacity = '0';
                        explosion.style.transform = 'scale(0)';
                        optionsContainer.innerHTML = '';
                        loadQuestion();
                    }
                }, 800);
            }
        }

        function endGame(reason) {
            if (gameOver) return;
            gameOver = true;

            clearInterval(timer);

            const endTime = new Date().getTime();
            const timeUsed = Math.floor((endTime - startTime) / 1000);

            finalScoreDisplay.textContent = score;
            timeUsedDisplay.textContent = timeUsed;
            
            gameScreen.classList.add('hidden');
            endScreen.classList.add('active');
        }
        
        // æ’­æ”¾éŸ³æ•ˆ
        function playSound(type) {
            if (type === 'correct') {
                const audio = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3');
                audio.volume = 0.5;
                audio.play().catch(e => console.log('éŸ³æ•ˆæ’­æ”¾å¤±æ•—:', e));
            } else if (type === 'explosion') {
                const audio = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-bomb-explosion-1680.mp3');
                audio.volume = 0.5;
                audio.play().catch(e => console.log('éŸ³æ•ˆæ’­æ”¾å¤±æ•—:', e));
            }
        }
        
        // å‰µå»ºå½©è‰²ç´™èŠ±æ•ˆæœ
        function createConfetti() {
            const colors = ['#ff8b94', '#ffaaa5', '#a8e6cf', '#dcedc1', '#6b5b95', '#ffd3b6'];
            const confettiCount = 50;
            
            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti-piece';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.top = -10 + 'px';
                confetti.style.transform = 'rotate(' + Math.random() * 360 + 'deg)';
                
                const animationDuration = Math.random() * 2 + 1;
                confetti.style.animation = `fall ${animationDuration}s linear forwards`;
                
                confettiContainer.appendChild(confetti);
                
                setTimeout(() => {
                    confetti.style.top = '100%';
                    confetti.style.opacity = '1';
                    confetti.style.transform = `rotate(${Math.random() * 360}deg) translateX(${Math.random() * 100 - 50}px)`;
                }, 10);
                
                setTimeout(() => {
                    confetti.remove();
                }, animationDuration * 1000);
            }
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes fall {
                    to {
                        top: 100%;
                        opacity: 0;
                        transform: rotate(360deg) translateX(${Math.random() * 100 - 50}px);
                    }
                }
            `;
            document.head.appendChild(style);
        }
        
        // æ›´æ–°è¨ˆæ™‚å™¨ï¼šæ•´å ´éŠæˆ²å€’æ•¸
        function updateTimer() {
            if (gameOver) {
                clearInterval(timer);
                return;
            }

            timeLeft -= 0.1;
            if (timeLeft < 0) timeLeft = 0;

            const percentage = (timeLeft / totalGameTime) * 100;
            timerBar.style.width = `${percentage}%`;
            
            const currentNumber = Math.ceil(timeLeft);
            countdownDisplay.textContent = formatTime(timeLeft);
            
            if (currentNumber !== lastCountdownNumber) {
                lastCountdownNumber = currentNumber;
                countdownDisplay.className = 'countdown pulse';
                
                setTimeout(() => {
                    if (!gameOver) countdownDisplay.className = 'countdown';
                }, 300);
            }
            
            fuse.style.width = `${Math.max(percentage * 0.8, 0)}px`;
            
            if (percentage < 20) {
                timerBar.style.background = 'linear-gradient(to right, #ff0000, #ff6600)';
                countdownDisplay.style.color = '#ff0000';
                countdownDisplay.style.fontSize = '1.7rem';
                flame.style.opacity = '1';
                flame.style.transform = 'scale(1)';
            } else if (percentage < 50) {
                timerBar.style.background = 'linear-gradient(to right, #ff6600, #ff8b94)';
                countdownDisplay.style.color = '#ff6600';
                countdownDisplay.style.fontSize = '1.6rem';
                flame.style.opacity = '0.7';
                flame.style.transform = 'scale(0.7)';
            } else {
                timerBar.style.background = 'linear-gradient(to right, #ff8b94, #ffaaa5)';
                countdownDisplay.style.color = '#ff8b94';
                countdownDisplay.style.fontSize = '1.5rem';
                flame.style.opacity = '0';
                flame.style.transform = 'scale(0)';
            }
            
            if (timeLeft <= 0) {
                clearInterval(timer);
                endGame('time');
            }
        }
        
        // è¼”åŠ©å‡½æ•¸ï¼šæ‰“äº‚æ•¸çµ„
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        // æ™‚é–“é¸æ“‡æŒ‰éˆ•äº‹ä»¶
        timeButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                timeButtons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                // åªåœ¨é–‹å§‹ç•«é¢èª¿æ•´é¡¯ç¤º
                if (!gameOver && !gameScreen || startScreen && !startScreen.classList.contains('hidden')) {
                    totalGameTime = parseInt(btn.dataset.time, 10);
                    timeLeft = totalGameTime;
                    countdownDisplay.textContent = formatTime(timeLeft);
                    timerBar.style.width = '100%';
                }
            });
        });

        // äº‹ä»¶ç›£è½å™¨
        startBtn.addEventListener('click', startGame);
        restartBtn.addEventListener('click', initGame);
        
        // é˜²æ­¢åŒå‡»ç¼©æ”¾
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(e) {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) e.preventDefault();
            lastTouchEnd = now;
        }, { passive: false });
        
        // çª—å£å¤§å°æ”¹å˜æ—¶é‡æ–°æ£€æµ‹è®¾å¤‡
        window.addEventListener('resize', function() {
            setTimeout(detectDevice, 100);
        });
        
        // åˆå§‹åŒ–éŠæˆ²å’Œè®¾å¤‡æ£€æµ‹
        initGame();
        detectDevice();
    </script>
</body>
</html>
